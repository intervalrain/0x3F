---
title: "數論介紹"
order: 0
description: "數論的基本概念與在算法競賽中的應用"
tags: ["Number Theory", "Mathematics", "Introduction"]
---

# 0. 數論介紹

## 什麼是數論？

數論（Number Theory）是研究整數性質的數學分支，被譽為「數學的皇后」。在算法競賽與實際應用中，數論提供了強大的數學工具，用於解決各種計算問題。

## 數論在算法競賽中的重要性

數論在程式設計競賽中扮演關鍵角色，主要原因包括：

1. **密碼學基礎**：RSA 加密、數字簽名等現代密碼系統的核心
2. **常見題型**：競賽中頻繁出現的質數、GCD/LCM、模運算問題
3. **算法優化**：利用數學性質將 O(n) 優化到 O(log n) 甚至 O(1)
4. **組合數學**：計數問題、排列組合的計算基礎

## 基本概念

### 1. 整除性（Divisibility）

**定義**：對於整數 a 和 b（b ≠ 0），如果存在整數 k 使得 a = kb，則稱 b 整除 a，記作 `b | a`。

- **讀法**：「b divides a」或「a is divisible by b」
- **範例**：`6 | 12`（6 整除 12），因為 12 = 6 × 2

**基本性質**：
- 若 `a | b` 且 `b | c`，則 `a | c`（傳遞性）
- 若 `a | b` 且 `a | c`，則 `a | (b ± c)`
- 若 `a | b`，則對任意整數 c，有 `a | bc`

### 2. 質數與合數

**質數（Prime）**：大於 1 的自然數，只能被 1 和自己整除。
- 範例：2, 3, 5, 7, 11, 13, 17, 19, 23, 29, ...
- **特殊性**：2 是唯一的偶質數

**合數（Composite）**：大於 1 且不是質數的自然數（至少有三個因數）。
- 範例：4, 6, 8, 9, 10, 12, 14, 15, 16, 18, ...

**注意**：1 既不是質數也不是合數。

**算術基本定理**：任何大於 1 的整數都可以唯一地表示為質數的乘積（不考慮順序）。
```
60 = 2² × 3 × 5
```

### 3. 因數與倍數

**因數（Factor/Divisor）**：若 `a | b`，則 a 是 b 的因數，b 是 a 的倍數。

**範例**：12 的因數有 1, 2, 3, 4, 6, 12

**因數個數**：對於 n = p₁^k₁ × p₂^k₂ × ... × pₘ^kₘ
```
因數個數 = (k₁ + 1) × (k₂ + 1) × ... × (kₘ + 1)
```

**因數和**：
```
因數和 = (1 + p₁ + p₁² + ... + p₁^k₁) × (1 + p₂ + p₂² + ... + p₂^k₂) × ...
```

### 4. 互質（Coprime/Relatively Prime）

**定義**：若 gcd(a, b) = 1，則稱 a 和 b 互質。

**範例**：
- 8 和 15 互質（gcd(8, 15) = 1）
- 8 和 12 不互質（gcd(8, 12) = 4）

**性質**：
- 任意兩個連續整數互質：gcd(n, n+1) = 1
- 若 p 是質數且不整除 a，則 gcd(a, p) = 1

## 常用數學符號

### 取整函數

- **下取整（Floor）**：`⌊x⌋` 表示不大於 x 的最大整數
  - 範例：`⌊3.7⌋ = 3`，`⌊-2.3⌋ = -3`
  - C++：`floor(x)` 或對正整數 `x / y`

- **上取整（Ceiling）**：`⌈x⌉` 表示不小於 x 的最小整數
  - 範例：`⌈3.2⌉ = 4`，`⌈-2.7⌉ = -2`
  - C++：`ceil(x)` 或對正整數 `(x + y - 1) / y`

### 整除符號

- **`a | b`**：a 整除 b
- **`a ∤ b`**：a 不整除 b

### 最大公因數與最小公倍數

- **`gcd(a, b)`**：Greatest Common Divisor，最大公因數
  - 範例：gcd(12, 18) = 6

- **`lcm(a, b)`**：Least Common Multiple，最小公倍數
  - 範例：lcm(12, 18) = 36
  - 關係：`lcm(a, b) × gcd(a, b) = a × b`

### 同餘符號

- **`a ≡ b (mod m)`**：a 和 b 模 m 同餘
  - 意義：a 和 b 除以 m 的餘數相同
  - 範例：`17 ≡ 5 (mod 12)`（因為 17 mod 12 = 5 mod 12 = 5）
  - 等價於：`m | (a - b)`

## C++ 中的基本實現

### 整除判斷

```cpp
bool isDivisible(int a, int b) {
    return a % b == 0;
}
```

### GCD 實現

```cpp
// C++17 標準庫
#include <numeric>
int g = std::gcd(a, b);

// 或使用 GCC 內建
int g = __gcd(a, b);

// 手動實現（輾轉相除法）
int gcd(int a, int b) {
    return b == 0 ? a : gcd(b, a % b);
}
```

### LCM 實現

```cpp
// C++17 標準庫
#include <numeric>
long long l = std::lcm(a, b);

// 手動實現（防止溢位）
long long lcm(long long a, long long b) {
    return a / gcd(a, b) * b;  // 先除後乘
}
```

### 質數判定（基礎版）

```cpp
bool isPrime(int n) {
    if (n < 2) return false;
    if (n == 2) return true;
    if (n % 2 == 0) return false;

    for (int i = 3; i * i <= n; i += 2) {
        if (n % i == 0) return false;
    }
    return true;
}
```

## 常見陷阱與注意事項

### 1. 整數溢位

```cpp
// 錯誤：可能溢位
long long lcm = a * b / gcd(a, b);

// 正確：先除後乘
long long lcm = a / gcd(a, b) * b;
```

### 2. 負數取模

```cpp
// C++ 中負數取模結果可能是負數
int result = -5 % 3;  // 可能是 -2

// 確保非負結果
int safeMod(int a, int m) {
    return ((a % m) + m) % m;
}
```

### 3. 0 的特殊性

- gcd(0, a) = a（0 被任何數整除）
- 不能對 0 取模
- 0 不是質數也不是合數

### 4. 1 的特殊性

- 1 不是質數（定義：質數大於 1）
- gcd(1, a) = 1（1 與任何數互質）
- 1 是所有數的因數

## 為什麼學數論？

### 1. 密碼學應用

現代加密系統的核心：
- **RSA 加密**：基於大質數分解的困難性
- **Diffie-Hellman 金鑰交換**：基於離散對數問題
- **橢圓曲線密碼學**：基於數論中的橢圓曲線

### 2. 算法優化

利用數學性質大幅提升效率：
- Fibonacci 數列：O(n) → O(log n)（矩陣快速冪）
- 因數和計算：O(n) → O(√n)（質因數分解）
- 大數冪運算：O(n) → O(log n)（快速冪）

### 3. 競賽常見題型

- 質數相關：篩法、質因數分解
- GCD/LCM：最大公因數、最小公倍數
- 模運算：同餘、模反元素
- 組合計數：排列組合、卡特蘭數

### 4. 數學美感

數論蘊含許多優雅的定理：
- **費馬小定理**：`a^(p-1) ≡ 1 (mod p)`（p 為質數）
- **歐拉定理**：`a^φ(n) ≡ 1 (mod n)`（a 與 n 互質）
- **中國餘數定理**：求解同餘方程組

## 學習路徑

```
基礎概念（整除、質數、GCD/LCM）
    ↓
模運算與同餘性質
    ↓
質數相關算法（篩法、質因數分解）
    ↓
快速冪與矩陣快速冪
    ↓
進階主題（歐拉函數、擴展歐幾里得、CRT）
    ↓
專業領域（莫比烏斯函數、米勒-拉賓測試）
```

## 本章節概覽

接下來我們將深入學習以下主題：

1. **同餘性質**：模運算、模反元素、大數處理
2. **GCD/LCM**：輾轉相除法、擴展歐幾里得
3. **質數**：質數判定、埃拉托斯特尼篩法、質因數分解
4. **快速冪**：分治思想、模快速冪、矩陣快速冪
5. **歐拉函數**：φ(n) 的計算與應用
6. **擴展歐幾里得**：線性同餘方程、中國餘數定理
7. **進階主題**：莫比烏斯函數、分段篩法、米勒-拉賓測試

讓我們開始探索數論的奇妙世界！
